<div class="m-5">
  <h1>Find your party buddy to protect you!</h1>
</div>

<div class="d-flex flex-wrap light-bckgrnd">
  <div class="w-100 mx-5 p-5 search-bar">
    <%= form_with url: root_path, method: :get, class: "d-flex" do %>
    <%= text_field_tag :query, params[:query], class: "form-control", placeholder: "Type a keyword" %>
    <%= submit_tag "Search", class: "btn btn-primary" %>
  </div>
  <div class="m-3 mb-5 px-5">
    <% if @listings.any? %>
      <div class="d-flex justify-content-evenly flex-wrap">
        <% @listings.each do |listing| %>
          <div class="card-category m-3 text-center">
            <%= link_to(listing_path(listing), class:'text-decoration-none ')  do  %>
              <div class="card-display" style="background-image: url('<%= cl_image_path listing.photo.key %>')" ></div>
              <h2 class="p-3"><%= listing.title %></h2>
              <p class="p-3">🌍 location: <%= listing.location %></br>
              💲 price: <%= listing.price %></p>
            <% end %>
          </div>
        <% end %>
      </div>
    <% else %>
      <em>Sorry, no results</em>
    <% end %>
    <% end %>
  </div>
  <div style="width: 100%; height: 600px;"
    data-controller="map"
    data-map-markers-value="<%= @markers.to_json %>"
    data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>
